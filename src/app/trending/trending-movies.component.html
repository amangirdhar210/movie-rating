<div class="trending-container">
  <div class="header-section">
    <h1 class="page-title">
      {{ isSearchMode ? "Search Results" : "Trending Movies" }}
    </h1>

    <div class="search-container">
      <div class="search-input-wrapper">
        <i class="pi pi-search search-icon"></i>
        <input
          type="text"
          pInputText
          [(ngModel)]="searchQuery"
          (keyup.enter)="onSearch()"
          placeholder="Search for movies..."
          class="search-input"
        />
      </div>
      <button
        pButton
        label="Search"
        icon="pi pi-search"
        (click)="onSearch()"
        [disabled]="loading"
        class="search-button"
      ></button>
      <button
        *ngIf="isSearchMode"
        pButton
        label="Clear"
        icon="pi pi-times"
        (click)="loadTrendingMovies(1)"
        class="p-button-secondary clear-button"
      ></button>
    </div>
  </div>

  <div *ngIf="loading" class="loading-container">
    <p-progressSpinner></p-progressSpinner>
  </div>

  <div *ngIf="!loading && movies.length === 0" class="empty-state">
    <i class="pi pi-film empty-icon"></i>
    <p class="empty-text">No movies found</p>
  </div>

  <div *ngIf="!loading && movies.length > 0" class="content-section">
    <div class="movies-grid">
      <app-movie-card
        *ngFor="let movie of movies"
        [movie]="movie"
        [isFavourite]="isFavourite(movie.id)"
        [userRating]="getUserRating(movie.id)"
        (movieClick)="onMovieClick($event)"
      ></app-movie-card>
    </div>

    <div class="pagination-section">
      <app-paginator
        [totalRecords]="totalResults"
        [rows]="20"
        [currentPage]="currentPage"
        (pageChange)="onPageChange($event)"
      ></app-paginator>
    </div>
  </div>
</div>

<app-movie-detail-modal
  [(visible)]="showModal"
  [movie]="selectedMovie"
  [isFavourite]="selectedMovie ? isFavourite(selectedMovie.id) : false"
  [userRating]="selectedMovie ? getUserRating(selectedMovie.id) : 0"
  (toggleFavourite)="onToggleFavourite($event)"
  (rateMovie)="onRateMovie($event)"
></app-movie-detail-modal>
